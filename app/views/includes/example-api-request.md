## Example API requests and sandbox

### `GET` ValueSet/$expand

The most used request. Use the `$expand` operation to search the full list of codes in a ValueSet.

You can create a more precise search using parameters like `filter`, which lets you use a term to search a ValueSet. You can constrain your search further using [SNOMED CT Expression Constraint Language (ECL) (opens in a new tab)](https://ontoserver.csiro.au/shrimp/ecl_help.html), which helps to define implicit ValueSets.

{% from 'components/details/macro.njk' import details %}

<div class="nhsuk-expander-group">
{{ details({
  "classes": "nhsuk-expander",
  "text": "Get sandbox access",
  "HTML": "<h4>Searching for a peanut allergy SNOMED CT code</h4><h5>Scenario</h5><p>Your app records a patient's allergy information and the data needs to be sent to NHS Wales as a SNOMED CT code.</p><p>You can use the ValueSet/$expand operation to search for a term by identifying the ValueSet and using parameters to narrow your search. We'll use 'peanut allergy' as our example.</p><h5>Request and parameters</h5><p><code>GET /ValueSet/$expand?filter=&peanut&url=http://example.url</code></p>
  <ul><li>the <code>filter</code> parameter is the term that you're searching within the ValueSet, in this case 'peanut'</li><li>the <code>url</code> parameter identifies the ValueSet to search in</li></ul><h5>Identifying the ValueSet</h5><p>Your next step is constaining the vast number of SNOMED CT codes to a ValueSet that contains only the codes for allergies. Organisations can define their own ValueSets, but you may find it simpler to use the <a href=\"https://www.hl7.org/fhir/snomedct.html#implicit\" target=\"_blank\">implicit ValueSets for SNOMED CT (opens in a new tab)</a>.</p><p>SNOMED CT implicit ValueSets are not already defined. They are implied by the <code>url</code> parameter that is used to identify the ValueSet. For the <code>url</code> parameter, use the SNOMED CT url and add a <code>fhir_vs</code> query parameter, for example:</p><ul><li><code> http://snomed.info/sct?fhir_vs</code> identifies an implicit ValueSet that contains all SNOMED CT codes</li><li><code> http://snomed.info/sct?fhir_vs=ecl/<419199007</code> identifies an implicit ValueSet that contains only allergies - <code><419199007</code> in SNOMEC CT ECL means all child concepts related to the ValueSet code for 'allergy to substance'</li></ul><h5>Result</h5><p>The request to find the SNOMED CT code for a peanut allergy in a ValueSet containing all allergy codes is:</p><p><code>GET /ValueSet/$expand?filter=peanut&url=http://snomed.info/sct?fhir_vs=ecl/<419199007</code><p>The response is the filtered ValueSet resource, and the <code>contains</code> element is an array containing all matching codes. In this example, there is only one matching code:</p><p><code>{<br>   \"system\":  \"http://snomed.info/sct\",<br>   \"code\":   \"91935009\",<br>   \"display\":   \"Allergy to peanut\"<br>}</code></p><p>So, the code for a peanut allergy is 91935009.</p>"
}) }}
{{ details({
  "classes": "nhsuk-expander",
  "text": "View request and parameters",
  "HTML": "<h4>Request</h4><p><code>GET https://sandbox.api.nhs.wales/wrds/fhir-terminology/ValueSet/$expand[?url][&filter][&count]</code></p><br></br><table role=\"table\" class=\"nhsuk-table-responsive\"><caption class=\"nhsuk-table__caption\">Request parameters</caption><thead role=\"rowgroup\" class=\"nhsuk-table__head\"><tr role=\"row\"><th role=\"columnheader\" class=\"\" scope=\"col\">Name</th><th role=\"columnheader\" class=\"\" scope=\"col\">In</th><th role=\"columnheader\" class=\"\" scope=\"col\">Required</th><th role=\"columnheader\" class=\"\" scope=\"col\">Type</th><th role=\"columnheader\" class=\"\" scope=\"col\">Description</th></tr></thead><tbody class=\"nhsuk-table__body\"><tr role=\"row\" class=\"nhsuk-table__row\"><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Name </span><code>url</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">In </span>query</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Required </span>false</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Type </span><code>string</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Description </span> The uri that identifies the value set to search in</td></tr><tr role=\"row\" class=\"nhsuk-table__row\"><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Name </span><code>filter</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">In </span>query</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Required </span>false</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Type </span><code>string</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Description </span> The term to search for in the ValueSet</td></tr><tr role=\"row\" class=\"nhsuk-table__row\"><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Name </span><code>count</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">In </span>query</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Required </span>false</td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Type </span><code>integer</code></td><td role=\"cell\" class=\"nhsuk-table__cell\"><span class=\"nhsuk-table-responsive__heading\">Description </span> The number of results to return</td></tr></tbody></table><br></br><h4>Response: 200 OK</h4><p>Success</p>"
}) }}
</div>
